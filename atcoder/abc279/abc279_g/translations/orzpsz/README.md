---
title: "ABC279_G_translation"
tags: ["dp"]
author: "houzhiyuan"
created: "2022-12-3"
---

### 题意

有一个 $1\times N$ 的矩形，从左到右被标号为 $1...N$。

高桥准备了 $C$ 种颜色，每个格子涂成 $C$ 种颜色中的一种，需要满足对于任意一个长度为 $K$ 的连续段最多出现两种颜色。

也就是对于任意 $1\le i\le N-K+1$，都需要满足 $i,i+1,...,i+K-1$ 种最多出现两种颜色。

求有多少种合法的染色方案，答案对 $998244353$ 取模。

### 数据范围

- $2\le K\le N\le 10^6$
- $1\le C\le 10^9$

---

### 输入格式

一行三个数 $N,K,C$。

### 输出格式

一行一个数，表示答案。

---

### 样例输入1

```
3 3 3
```

### 样例输出1

```
21
```

### 样例解释1

对于 $1\times 3$ 的矩形，任意涂色有 $27$ 种方案，其中有 $6$ 种方案涂 $3$ 种不同的颜色，不合法，因此总方案数是 $21$。

---

### 样例输入2

```
10 5 2
```

### 样例输出2

```
1024
```

### 样例解释2

无论怎么染都合法。

---

### 样例输入3

```
998 244 353
```

### 样例输出3

```
952364159
```