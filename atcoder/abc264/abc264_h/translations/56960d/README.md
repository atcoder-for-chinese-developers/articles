---
title: "ABC264_Ex_translation.md"
tags: []
author: ""
created: ""
---

## 题意

有一棵大小为 $N$ 的树，编号为 $1...N$，根为 $1$，$i(\ge 2)$ 的父亲是 $P_i( < i)$。

对于每个 $1\le k\le N$，解决以下问题：

有 $2^{k-1}$ 中方案选出一个 $T=\{1,2...k\}$ 的子集 $S$，满足 $1\in S$。

求出有多少个 $S$ 满足它的导出子图是一棵满二叉树，且根为 $1$，答案对 $998244353$ 取模。

导出子图：

把点集 $S$ 取出，然后把所有满足 $i\in S,j\in S$ 的边 $(i,j)$ 取出后得到的子图。

满二叉树：

- 除了叶子节点，每个节点都有两个儿子。
- 每个叶子节点深度相同。

注意只有一个点的图也是满二叉树。

## 数据范围

- $1\le N\le 3\times  10^5$
- $1\le P_i < i $

## 输入格式

第一行一个数 $N$。

第二行 $N-1$ 个数，第 $i$ 个数表示 $P_{i+1}$。

## 输出格式

$N$ 行，第 $i$ 行表示 $k=i$ 时的答案。

## 样例

### 样例输入1

```
10
1 1 2 1 2 5 5 5 1
```

### 样例输出1

```
1
1
2
2
4
4
4
5
7
10
```

### 样例解释1

有以下方法满足条件：

- $\{1\}$

- $\{1,2,3\}$

- $\{1,2,5\},\{1,3,5\}$

- $\{1,2,4,5,6,7,8\}$

- $\{1,2,4,5,6,7,9\},\{1,2,4,5,6,8,9\}$

- $\{1,2,10\},\{1,3,10\},\{1,5,10\}$

### 样例输入2

```
1
```

### 样例输出2

```
1
```

### 样例输入3

```
10
1 2 3 4 5 6 7 8 9
```

### 样例输出3

```
1
1
1
1
1
1
1
1
1
1
```

### 样例输入4

```
13
1 1 1 2 2 2 3 3 3 4 4 4
```

### 样例输出4

```
1
1
2
4
4
4
4
4
7
13
13
19
31
```

