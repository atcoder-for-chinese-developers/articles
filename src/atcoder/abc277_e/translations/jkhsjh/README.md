---
title: "ABC227 E 翻译"
tags: []
author: "Acfboy"
created: "Sat, 19 Nov 2022 04:18:11 GMT"
---

### 问题描述

给你一张 $N$ 个点， $M$ 条边的无向图。  
对于 $i = 1, 2, \ldots, M$, 第 $i$ 条边是一条连接了 $u_i$ 和 $v_i$ 的无向边，如果 $a_i = 1$ 则初始时是可以通行的，如果 $a_i = 0$ 则不可以。  
另外，还有 $K$ 个转换器位于第 $s_1$, $s_2$, $\ldots$, $s_K$ 个点。  

高桥开始时位于点 $1$, 他会每秒中会选择执行**移动**或**转换**操作，一共可以执行任意多次。  

- **移动**: 选择一个和他当前所在的点直接有变相连的点，并移动到那个点上。  
- **执行转换**: 如果当前点上有一个转换器，按下按钮，所有边的可通行状态都会反转，即之前可以通行的现在不能通行了，之前不能通行的现在可以通行了。  

判断高桥是否可以到达点 $N$, 如果可以, 输出他在到达点 $N$ 之前执行的最少的**移动**操作数。

---
### 数据范围

- $2 \leq N \leq 2 \times 10^5$
- $1 \leq M \leq 2 \times 10^5$
- $0 \leq K \leq N$
- $1 \leq u_i, v_i \leq N$
- $u_i \neq v_i$
- $a_i \in \lbrace 0, 1\rbrace$
- $1 \leq s_1 \lt s_2 \lt \cdots \lt s_K \leq N$


---
### 输入格式

第一行两个整数 $N, M$，接下来输出这张图。

---
### 输出格式

如果高桥不能到达点 $N$, 输出 $-1$;  
如果可以, 输出他在到达点 $N$ 之前执行的最少的**移动**操作数。

---
### 样例输入 1

```
5 5 2
1 3 0
2 3 1
5 4 1
2 1 1
1 4 0
3 4
```

---
### 样例输出 1

```
5
```

高桥可以通过以下方式到达点 $N$  

- 从 $1$ 移动到 $2$。
- 从 $2$ 移动到 $3$。
- 使用在 $3$ 号点的转换器。这将反转所有边的联通状态。
- 从 $3$ 移动到 $1$。
- 从 $1$ 移动到 $4$。
- 使用在 $4$ 号点的转换器。 这将使所有边联通状态回到开始时。
- 从 $4$ 移动到 $5$。

这里移动了五次，可以证明，这是最小的移动次数。

---
### 样例输入 2

```
4 4 2
4 3 0
1 2 1
1 2 0
2 1 1
2 4
```

---
### 样例输出 2

```
-1
```

输入的图会不连通，或有重边。  
在这个样例中，高桥没有机会移动到 $N$, 所以你需要输出 $-1$。

---
