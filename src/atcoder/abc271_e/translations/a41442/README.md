---
title: "ABC271_E_translation.md"
tags: []
author: ""
created: ""
---

## 题意

给你一张 $N$ 个点 $M$ 条边的有向图，每条边有编号从 $1~M$。再给你一个长为 $K$ 的序列 $E_i$，你需要找到一条路径使得：

- 起点为 $1$，终点为 $N$。
- 经过边的编号为 $E$ 的一个子序列。

在所有的满足上述条件的路径中，输出最短的路径的长度。

## 数据范围

- $2\le N\le 2\times 10^5$。
- $1\le M,K\le 2\times 10^5$。
- $1\le A_i,B_i\le N,A_i\neq B_i(1\le i\le M)$。
- $1\le C_i\le 10^9(1\le i\le M)$。
- $1\le E_i\le M(1\le i\le K)$。
- 输入的所有数都是整数。

## 输入格式

第一行三个整数 $N,M,K$，

接下来 $M$ 行每行三个整数 $A_i,B_i,C_i$，表示一条从 $A_i$ 出发到 $B_i$ 的边，长度为 $C_i$。

接下来一行 $K$ 个数，表示序列 $E_i$。

## 输出格式

如果不存在满足条件的路径，输出一行 `-1`。

否则输出一行表示最短路径长度。

## 样例

### 样例输入1

```
3 4 4
1 2 2
2 3 2
1 3 3
1 3 5
4 2 1 2
```

### 样例输出1

```
4
```

### 样例解释1

$1\to 2\to 3$，使用边 $1,2$ 为最短路径。

### 样例输入2

```
3 2 3
1 2 1
2 3 1
2 1 1

```

### 样例输出2

```
-1
```

### 样例输入3

```
4 4 5
3 2 2
1 3 5
2 4 7
3 4 10
2 4 1 4 3
```

### 样例输出3

```
14
```

